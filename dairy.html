---
permalink: /diary/
---
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>While you were fighting</title>
   

    <!--link rel="preload" href="https://cdn.jsdelivr.net/npm/bulma@0.8.2/css/bulma.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"-->
    <!--noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.2/css/bulma.min.css"></noscript-->

    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <link defer href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&display=swap" rel="stylesheet">
    
    <link defer href="{{ '/assets/css/home.css' | prepend: site.baseurl }}" rel="stylesheet" type="text/css">
    <link defer href="{{ '/assets/css/diary.css' | prepend: site.baseurl }}" rel="stylesheet" type="text/css">
    <!--script src="{{ '/assets/scripts/whatapp-chat-parser.js' | prepend: site.baseurl }}"></script-->
    <!--script src="{{ '/assets/scripts/diary.js' | prepend: site.baseurl }}" type="module"></script-->
    <!--script src="{{ '/assets/scripts/diary-ui.js' | prepend: site.baseurl }}"></script-->
    <!--script src="{{ '/assets/scripts/diary-controller.js' | prepend: site.baseurl }}" ></script-->

    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js" integrity="sha384-NaWTHo/8YCBYJ59830LTz/P4aQZK1sS0SneOgAvhsIl3zBu8r9RevNg5lHCHAuQ/" crossorigin="anonymous"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js" integrity="sha256-O6polm3ZRTZEOAneYbvsKty3c3KRcDf20McwtlCga5s=" crossorigin="anonymous"></script>
    <script defer src="{{ '/assets/scripts/ostrich-regular-normal.js' | prepend: site.baseurl }}"></script>
    <script defer src="{{ '/assets/scripts/OstrichSans-Black-normal.js' | prepend: site.baseurl }}"></script>
    <script defer src="{{ '/assets/scripts/OpenSans-italic.js' | prepend: site.baseurl }}"></script>
    <script defer src="{{ '/assets/scripts/OpenSans-normal.js' | prepend: site.baseurl }}"></script>

    <script defer src="{{ '/assets/scripts/i18n.js' | prepend: site.baseurl }}"></script>
    <script src="{{ '/assets/scripts/html2canvas.min.js' | prepend: site.baseurl }}"></script>

</head>
<body>
    
    <!--img id='test' src="https://i1.ytimg.com/vi/7OnvJJn2iyA/maxresdefault.jpg">

    <img
    id='test'
    src="https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png" 
    height="220"
    width="200"
    class="watermark"-->


    <!--canvas id="the-canvas" style="  border: 1px solid black;
    direction: ltr;"></canvas-->
    <!--section>
        <div>
            <label for="myfile">Select files:</label>
            <input type="file" id="files" name="files" multiple>
        </div>
    </section-->
   

<!--script>

const splitTextInLines = (text, lineSize) => {

    const lines = [];

    const words = text.split(' ');

    let tempSize = 0;
    let line = [];

    for(word of words) {
        if(word.length + 1 + tempSize > lineSize) {
            lines.push(line.join(' '));
            line = [];
            tempSize = 0;
        } 
        line.push(word);
        tempSize+= word.length + 1;
        
    }
    lines.push(line.join(' '));

    return lines;
}

let doc = new jsPDF(); 

const pdfData = doc.output('arraybuffer');

// The workerSrc property shall be specified.
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.js';

// Asynchronous download of PDF
var loadingTask = pdfjsLib.getDocument(pdfData);
loadingTask.promise.then(function(pdf) {
  console.log('PDF loaded');
  
  // Fetch the first page
  var pageNumber = 1;
  pdf.getPage(pageNumber).then(function(page) {
    console.log('Page loaded');
    
    var scale = 1.5;
    var viewport = page.getViewport({scale: scale});

    // Prepare canvas using PDF page dimensions
    var canvas = document.getElementById('the-canvas');
    var context = canvas.getContext('2d');
    canvas.height = viewport.height;
    canvas.width = viewport.width;

    // Render PDF page into canvas context
    var renderContext = {
      canvasContext: context,
      viewport: viewport
    };
    var renderTask = page.render(renderContext);
    renderTask.promise.then(function () {
      console.log('Page rendered');
    });
  });
}, function (reason) {
  // PDF loading error
  console.error(reason);
});



</script-->
<script>
/*
const youtubeTest = async (link) => {


   const url = `https://www.youtube.com/oembed?url=${link}&format=json&origin=http://localhost:4000`;
   // const url = 'https://img.youtube.com/vi/7OnvJJn2iyA/0.jpg';

   //const url = 'https://i1.ytimg.com/vi/7OnvJJn2iyA/maxresdefault.jpg';
//let response = await fetch(url);
console.log(response);

//let blob = await response.blob();
}*/

/*
const cors_api_url = 'https://cors-anywhere.herokuapp.com/';
const doCORSRequest = (options, printResult) => {
    var x = new XMLHttpRequest();
    x.open(options.method, cors_api_url + options.url);
    x.responseType = "blob";
    x.onload = x.onerror = async function() {
      printResult(
        options.method + ' ' + options.url + '\n' +
        x.status + ' ' + x.statusText + '\n\n' +
        (x.response || '')
      );

      const getImageFromBlob = (blob) => {

        var reader = new FileReader();
        reader.readAsDataURL(blob); 

        return new Promise((resolve, reject) => {

            reader.onloadend = () => resolve(reader.result);
            
        });
        }
        const r = await getImageFromBlob(x.response);
        console.log(r);

      let imgss = document.createElement('img');
      imgss.src = r;
      document.body.appendChild(imgss);
    };
    x.send(options.data);
  }


      doCORSRequest({
        method: 'GET',
        url: 'https://i1.ytimg.com/vi/7OnvJJn2iyA/maxresdefault.jpg',
        data: ''
      }, function printResult(result) {
        console.log(result);
      });
  */

/*
const doCORSRequest = async (url, responseType) => {

    const fetch = async(url) => {
        const cors_api_url = 'https://cors-anywhere.herokuapp.com/';
        var x = new XMLHttpRequest();
        x.open('GET', cors_api_url + url);
        x.responseType = responseType;
        x.send();
        return new Promise((resolve, reject) => { 
            x.onload = () => resolve(x.response);
        });
    };
    
    const convertBlobToBase64 = async(blob) => {
        var reader = new FileReader();
        reader.readAsDataURL(blob); 
        return new Promise((resolve, reject) => {
            reader.onloadend = () => resolve(reader.result);
        });
    }

    const response = await fetch(url);
    if(responseType === 'blob')
        return await convertBlobToBase64(response);
    else if(responseType === 'json')
        return response;

}

doCORSRequest('https://i.ytimg.com/vi/7OnvJJn2iyA/hqdefault.jpg', 'blob').then((v) => console.log(v) );
doCORSRequest('https://www.youtube.com/oembed?url=https://youtu.be/7OnvJJn2iyA&format=json ', 'json').then((v) => console.log(v) );

*/
//youtubeTest('https://youtu.be/7OnvJJn2iyA');
/*
let iframe = document.createElement('iframe');
iframe.width = 480;
iframe.height = 270;
iframe.src = 'https://www.youtube.com/embed/7OnvJJn2iyA?feature=oembed';
iframe.frameBorder = 0; 
iframe.allow = 'accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture';
iframe.allowFullscreen = true;
document.body.appendChild(iframe);

iframe.onload = () => {
    let r =  iframe //.getElementsByClassName('ytp-cued-thumbnail-overlay-image');
console.log(r);
}

    var youtube_video_id = iframe.src.match(/youtube\.com.*(\?v=|\/embed\/)(.{11})/).pop();
    
    if (youtube_video_id.length == 11) {
        var video_thumbnail = $('<img src="//img.youtube.com/vi/'+youtube_video_id+'/0.jpg">');
        $('body').append(video_thumbnail);
    
        $('img:first').click(function() {
            $('iframe:first').fadeToggle('400');
        });
    }
*/

//let imageTest = document.getElementById('test');//document.createElement('img');
//let imageTest = document.getElementById('test');
//imageTest.src = 'https://i1.ytimg.com/vi/7OnvJJn2iyA/maxresdefault.jpg';
//document.body.appendChild(imageTest);

//let canvass = document.createElement('canvas');
//document.body.appendChild(canvass);
//canvass.getContext("2d").drawImage(imageTest, 530, 298);
//let data = canvas.toDataURL();
//console.log(data);



/*
var c = document.getElementById("myCanvas");
var ctx = c.getContext("2d");
var img = document.getElementById("preview");
ctx.drawImage(img, 10, 10);
alert(c.toDataURL());*/

</script>

    <script type="module">




        
        // First we get the viewport height and we multiple it by 1% to get a value for a vh unit
        let vh = window.innerHeight * 0.01;
        // Then we set the value in the --vh custom property to the root of the document
        document.documentElement.style.setProperty('--vh', `${vh}px`);

        // We listen to the resize event
        window.addEventListener('resize', () => {
            // We execute the same script as before
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        });


                        

    
      import Diary from "{{ '/assets/scripts/diary.js' | prepend: site.baseurl }}";
        
      document.body.addEventListener("load", Diary());
      

        //import DiaryTemplates from "{{ '/assets/scripts/diary-templates.js' | prepend: site.baseurl }}";
       // DiaryTemplates().messagesTwoUsersPage();
        /*
        let open = true;

        let filesInput = document.getElementById('files');

        const files = {};
        const users = [];

        let parsedMessages;
        let parsedFiles;

        const messagesSortedByDay = {};
        const challenges = [];
        */

        /*
        const ui = DiaryUI();
        ui.startTopicUI();
        ui.renderTopicsFound(['topic']);
        */

       // const diaryController = DiaryController();


        /*
        filesInput.addEventListener("change", async () => {

                const parser = WhatsAppChatParser();
                const whatsAppChat = await parser.start(filesInput);                
                console.log(whatsAppChat);
                const {messageMap, orderedMessages, users, files} = whatsAppChat;

                const dairy = Dairy();
                dairy.setWhatsAppChat(whatsAppChat);
                const topics = dairy.findTopics();
                console.log(topics);
                
                startTopicUI();
                renderTopics(topics);
                
                const chatContainer = document.getElementById('chat-messages');

                let lastDate;

                for(message of orderedMessages) {

                    let parsedMessage = messageMap[message];
                    
                    if(lastDate == null || parsedMessage.date != lastDate) {

                        const chatDateDivider = document.createElement('div');
                        chatDateDivider.classList.add('chat-date-divider');
                        chatDateDivider.innerText = parsedMessage.date;
                        chatContainer.appendChild(chatDateDivider);

                        lastDate = parsedMessage.date;

                        messagesSortedByDay[lastDate] = [parsedMessage];
                    } else {
                        messagesSortedByDay[lastDate].push(parsedMessage);
                    }

                    const chatMessage = document.createElement('div');
                    chatMessage.classList.add('chat-message');
                    chatContainer.appendChild(chatMessage);
      
                    const chatMessageUser = document.createElement('div');
                    chatMessageUser.innerText = parsedMessage.user;
                    chatMessageUser.classList.add('chat-message-name');

                    for(user of users) {
                        if(user.name == parsedMessage.user)
                            chatMessageUser.style = `color: ${user.color}`;
                    }

                    chatMessage.appendChild(chatMessageUser);

                    const chatMessageBody = document.createElement('div');
                    chatMessageBody.innerText = parsedMessage.text;
                    chatMessage.appendChild(chatMessageBody);

                    if(parsedMessage.file != '') {
                        if(files[parsedMessage.file].type.includes('audio')) {
                            const audio = document.createElement('audio');
                            audio.setAttribute('controls', true);

                            const source = document.createElement('source');
                            source.setAttribute('src', files[parsedMessage.file].data);
                            source.setAttribute('type', files[parsedMessage.file].type);

                            audio.appendChild(source);
                            chatMessageBody.appendChild(audio);

                        } else if(files[parsedMessage.file].type.includes('video')) {
                            const video = document.createElement('video');
                            video.width = 320;
                            video.height = 240;
                            video.controls = true;
                            video.autoplay = true;
                            video.loop = true;
                            video.muted = true;

                            const source = document.createElement('source');
                            source.src = files[parsedMessage.file].data;
                            source.type = files[parsedMessage.file].type;

                            video.appendChild(source);
                            chatMessageBody.appendChild(video);
                        } else if(files[parsedMessage.file].type.includes('image')) {
                            const image = document.createElement('img');
                            image.src = files[parsedMessage.file].data;
                            image.width = 320;
                            image.height = 240;
                            chatMessageBody.appendChild(image);
                        }

                    }

                    const chatMessageTime = document.createElement('div');
                    chatMessageTime.innerText = parsedMessage.time;
                    chatMessageTime.classList.add('chat-message-time');
                    chatMessageBody.appendChild(chatMessageTime);

                }

                let dateList = document.getElementById('day-list');
                
              

            });*/
            

    </script>

</body>
</html>