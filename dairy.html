---
permalink: /diary/
---
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>While you were fighting</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.2/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&display=swap" rel="stylesheet">
    <link href="{{ '/assets/css/diary.css' | prepend: site.baseurl }}" rel="stylesheet" type="text/css">
    <script src="{{ '/assets/scripts/whatapp-chat-parser.js' | prepend: site.baseurl }}"></script>
    <script src="{{ '/assets/scripts/dairy.js' | prepend: site.baseurl }}"></script>
</head>
<body>
    <!--section>
        <div>
            <label for="myfile">Select files:</label>
            <input type="file" id="files" name="files" multiple>
        </div>
    </section-->
   

 
    <script>
        
        // First we get the viewport height and we multiple it by 1% to get a value for a vh unit
        let vh = window.innerHeight * 0.01;
        // Then we set the value in the --vh custom property to the root of the document
        document.documentElement.style.setProperty('--vh', `${vh}px`);

        // We listen to the resize event
        window.addEventListener('resize', () => {
            // We execute the same script as before
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        });

        let open = true;

        let filesInput = document.getElementById('files');

        const files = {};
        const users = [];

        let parsedMessages;
        let parsedFiles;

        const messagesSortedByDay = {};
        const challenges = [];

        

        /*
        filesInput.addEventListener("change", async () => {

                const parser = WhatsAppChatParser();
                const whatsAppChat = await parser.start(filesInput);                
                console.log(whatsAppChat);
                const {messageMap, orderedMessages, users, files} = whatsAppChat;

                const dairy = Dairy();
                dairy.setWhatsAppChat(whatsAppChat);
                const topics = dairy.findTopics();
                console.log(topics);
                
                startTopicUI();
                renderTopics(topics);
                
                const chatContainer = document.getElementById('chat-messages');

                let lastDate;

                for(message of orderedMessages) {

                    let parsedMessage = messageMap[message];
                    
                    if(lastDate == null || parsedMessage.date != lastDate) {

                        const chatDateDivider = document.createElement('div');
                        chatDateDivider.classList.add('chat-date-divider');
                        chatDateDivider.innerText = parsedMessage.date;
                        chatContainer.appendChild(chatDateDivider);

                        lastDate = parsedMessage.date;

                        messagesSortedByDay[lastDate] = [parsedMessage];
                    } else {
                        messagesSortedByDay[lastDate].push(parsedMessage);
                    }

                    const chatMessage = document.createElement('div');
                    chatMessage.classList.add('chat-message');
                    chatContainer.appendChild(chatMessage);
      
                    const chatMessageUser = document.createElement('div');
                    chatMessageUser.innerText = parsedMessage.user;
                    chatMessageUser.classList.add('chat-message-name');

                    for(user of users) {
                        if(user.name == parsedMessage.user)
                            chatMessageUser.style = `color: ${user.color}`;
                    }

                    chatMessage.appendChild(chatMessageUser);

                    const chatMessageBody = document.createElement('div');
                    chatMessageBody.innerText = parsedMessage.text;
                    chatMessage.appendChild(chatMessageBody);

                    if(parsedMessage.file != '') {
                        if(files[parsedMessage.file].type.includes('audio')) {
                            const audio = document.createElement('audio');
                            audio.setAttribute('controls', true);

                            const source = document.createElement('source');
                            source.setAttribute('src', files[parsedMessage.file].data);
                            source.setAttribute('type', files[parsedMessage.file].type);

                            audio.appendChild(source);
                            chatMessageBody.appendChild(audio);

                        } else if(files[parsedMessage.file].type.includes('video')) {
                            const video = document.createElement('video');
                            video.width = 320;
                            video.height = 240;
                            video.controls = true;
                            video.autoplay = true;
                            video.loop = true;
                            video.muted = true;

                            const source = document.createElement('source');
                            source.src = files[parsedMessage.file].data;
                            source.type = files[parsedMessage.file].type;

                            video.appendChild(source);
                            chatMessageBody.appendChild(video);
                        } else if(files[parsedMessage.file].type.includes('image')) {
                            const image = document.createElement('img');
                            image.src = files[parsedMessage.file].data;
                            image.width = 320;
                            image.height = 240;
                            chatMessageBody.appendChild(image);
                        }

                    }

                    const chatMessageTime = document.createElement('div');
                    chatMessageTime.innerText = parsedMessage.time;
                    chatMessageTime.classList.add('chat-message-time');
                    chatMessageBody.appendChild(chatMessageTime);

                }

                let dateList = document.getElementById('day-list');
                
              

            });*/
            
            const getRandomColor = () => {
                var letters = '0123456789ABCDEF';
                var color = '#';
                for (var i = 0; i < 6; i++) {
                    color += letters[Math.floor(Math.random() * 16)];
                }
                return color;
            }


            const startTopicUI = () => {

                const topicContainer = document.createElement('div');
                topicContainer.classList.add('topic-container');

                const topicContainerHeader = document.createElement('div');
                topicContainerHeader.classList.add('topic-container__level');
                topicContainerHeader.classList.add('topic-container__header');
                topicContainer.appendChild(topicContainerHeader);

                const headerText = document.createElement('div');
                headerText.id = 'topic-container-header-text';
                headerText.classList.add('topic-container__header__text');
                topicContainerHeader.appendChild(headerText);

                const topicContainerList = document.createElement('div');
                topicContainerList.id = 'topicList';
                topicContainerList.classList.add('topic-container__list');
                topicContainer.appendChild(topicContainerList);

                const topicContainerFooter = document.createElement('div');
                topicContainerFooter.classList.add('topic-container__level');
                topicContainerFooter.classList.add('topic-container__footer');
                topicContainer.appendChild(topicContainerFooter);

                const footerLeft =  document.createElement('div');
                footerLeft.id='topic-container-footer-left';
                footerLeft.classList.add('topic-container__footer__item');
                topicContainerFooter.appendChild(footerLeft);
/*
                const addTopicButton  = document.createElement('button');
                addTopicButton.classList.add('topic-button');
                addTopicButton.classList.add('topic-container__footer__item__button');
                addTopicButton.innerText = 'ADD TOPICS';
                addTopicButton.addEventListener('click', () => {
                    console.log('Add Topic Button');
                });                
                footerLeft.appendChild(addTopicButton);
*/
                const footerRight =  document.createElement('div');
                footerRight.id='topic-container-footer-right';
                footerRight.classList.add('topic-container__footer__item');
                topicContainerFooter.appendChild(footerRight);

                /*
                const thatsAllButton  = document.createElement('button');
                thatsAllButton.classList.add('topic-button');
                thatsAllButton.classList.add('topic-container__footer__item__button');
                thatsAllButton.innerText = 'THAT\'S All';

                thatsAllButton.addEventListener('click', () => {
                    console.log('Thats All Button');
                });

                footerRight.appendChild(thatsAllButton);
     */
                document.body.appendChild(topicContainer);

            }

            const clearTopicUI = () => {

                document.getElementById('topic-container-header-text').innerText = '';
                removeChildren('topicList');
                removeChildren('topic-container-footer-left');
                removeChildren('topic-container-footer-right');
              
            }

            const renderTopicsFound = (topics) => {

                document.getElementById('topic-container-header-text').innerText = 'We found the following daily topics you have been messaging about. Is this set complete? Or are there any topics you want to add tho this list?';
                
                renderTopics(topics);

                const addTopicButton  = document.createElement('button');
                addTopicButton.classList.add('topic-button');
                addTopicButton.classList.add('topic-container__footer__item__button');
                addTopicButton.innerText = 'ADD TOPICS';
                addTopicButton.addEventListener('click', () => {
                    console.log('Add Topic Button');
                    clearTopicUI();
                    renderAddTopicOptions();
                });                
                document.getElementById('topic-container-footer-left').appendChild(addTopicButton);

                const thatsAllButton  = document.createElement('button');
                thatsAllButton.classList.add('topic-button');
                thatsAllButton.classList.add('topic-container__footer__item__button');
                thatsAllButton.innerText = 'THAT\'S All';
                thatsAllButton.addEventListener('click', () => {
                    console.log('Thats All Button');
                });
                document.getElementById('topic-container-footer-right').appendChild(thatsAllButton);

            }

            const renderTopic = (day, topicData) => {
                
                const topicList = document.getElementById('topicList');

                const topic =  document.createElement('div');
                topic.classList.add('topic');

                const topicHeader = document.createElement('div');
                topicHeader.classList.add('topic__header');
                topic.appendChild(topicHeader);

                const color = getRandomColor();

                const topicHeaderDay =  document.createElement('div');
                topicHeaderDay.classList.add('topic__header__day');
                topicHeaderDay.innerText = `DAY ${day + 1}`;
                topicHeaderDay.style = `color: ${color};`
                topicHeader.appendChild(topicHeaderDay);

                const topicHeaderDate =  document.createElement('div');
                topicHeaderDate.classList.add('topic__header__date');
                topicHeaderDate.innerText = `2020/20/01`;
                topicHeaderDate.style = `color: ${color};`
                topicHeader.appendChild(topicHeaderDate);

                const topicHeaderEditButton = document.createElement('button');
                topicHeaderEditButton.classList.add('topic__header__edit-button');
                topicHeaderEditButton.addEventListener('click', () => {
                    console.log('Topic Edit Button');
                });
                topicHeader.appendChild(topicHeaderEditButton);

                const editButtonImage = document.createElement('img');
                editButtonImage.src = "{{ '/assets/images/edit.svg' | prepend: site.baseurl }}";
                editButtonImage.width = '25';
                editButtonImage.height = '25';
                topicHeaderEditButton.appendChild(editButtonImage);

                const topicHeaderDeleteButton = document.createElement('button');
                topicHeaderDeleteButton.classList.add('topic__header__delete-button');
                topicHeaderDeleteButton.addEventListener('click', () => {
                    console.log('Topic Delete Button');
                });
                topicHeader.appendChild(topicHeaderDeleteButton);

                const deleteButtonImage = document.createElement('img');
                deleteButtonImage.src = "{{ '/assets/images/delete.svg' | prepend: site.baseurl }}";
                deleteButtonImage.width = '25';
                deleteButtonImage.height = '25';
                topicHeaderDeleteButton.appendChild(deleteButtonImage);

                const topicText = document.createElement('div');
                topicText.innerText = `I am a TOPIC ${day}`;
                topic.appendChild(topicText);

                topicList.appendChild(topic);          
            }

            const renderTopics = (topics) => {

                for(topic of topics) {

                    for(let i = 0; i < 20; i++) {
                        renderTopic(i, topic);
                    }
     
                }

            }

            const removeChildren = (id) => {

                const myNode = document.getElementById(id);
                while (myNode.firstChild) {
                    myNode.removeChild(myNode.lastChild);
                }

            }

            const renderAddTopicOptions = () => {

                const headerText = document.getElementById('topic-container-header-text');
                headerText.innerText = 'New Topic From Where';

                const topicList = document.getElementById('topicList');

                const optionsContainer = document.createElement('div');
                optionsContainer.classList.add('topic__add-topic__options');

                const buttonsContainer = document.createElement('div');
                buttonsContainer.classList.add('topic__add-topic__buttons-container');
                optionsContainer.appendChild(buttonsContainer);

                const writeTopic = document.createElement('button');
                writeTopic.classList.add('topic-button');
                writeTopic.innerText = 'Write Topic';
                buttonsContainer.appendChild(writeTopic);

                const orText = document.createElement('div');
                orText.innerText = 'or';
                buttonsContainer.appendChild(orText);

                const selectTopic = document.createElement('button');
                selectTopic.classList.add('topic-button');
                selectTopic.innerText = 'Select from chat';
                buttonsContainer.appendChild(selectTopic);
                
                topicList.appendChild(optionsContainer);

                const backButton = document.createElement('button');
                backButton.classList.add('topic-button');
                backButton.classList.add('topic-container__footer__item__button');
                backButton.innerText = 'BACK';
                backButton.addEventListener('click', () => {
                    console.log('Back Button');
                    clearTopicUI();
                    renderTopicsFound(['topics']);
                });                
                document.getElementById('topic-container-footer-left').appendChild(backButton);

            }

            startTopicUI();
            renderTopicsFound(['but']);
            //renderAddTopicOptions();
            //renderTopics(["dsds"]);
                

    </script>

</body>
</html>